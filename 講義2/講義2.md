# 講義2: シェルスクリプトの基本とデバッグ

## 概要
この講義では、シェルスクリプトの基本的な要素に焦点を当て、シェルスクリプトの作成とデバッグに必要なスキルを習得します。シェルスクリプトは、コマンドライン環境で非常に強力なツールとして使用でき、自動化やタスクの効率化に役立ちます。

### 1. シェルスクリプトの基本構文

#### 所要時間: 約 15分

このセクションでは、シェルスクリプトの基本構文について学びます。

1. **シェルスクリプトの起動方法**
   - シェルスクリプトを実行する方法について説明します。
   - シェルスクリプトファイルに実行権限を与える方法を示し、例を挙げて説明します。
   - シェルの指定方法と実行コマンドについて説明します。
   
   **例:**
   ```shell
   $ chmod +x my_script.sh
   $ ./my_script.sh
   ```

1. **コメントの追加** 
   - コメントの重要性について説明し、コメントの追加方法を示します。
   - コメントはスクリプトの理解や共有に役立つ重要な要素です。
   
   **例:** 
   
   ```shell
   # これはシェルスクリプトのコメントの例です
   ``` 
2. **変数の宣言と使用** 
   - 変数の宣言方法と使用方法について説明します。
   - 変数はデータの格納に使用され、スクリプト内での情報の保持に役立ちます。
   
   **例:** 

   ```shell
   my_variable="Hello, World!"
   echo $my_variable
   ``` 
3. **コマンドの実行** 
   - シェルスクリプト内でコマンドを実行する方法について説明します。
   - コマンドの出力を変数に格納し、表示する方法を示します。

   **例:** 

   ```shell
   current_date=$(date)
   echo "現在の日付は: $current_date"
   ```

このセクションでは、シェルスクリプトの基本構文を理解し、具体的な実践例を通じて学生がスクリプトの作成と実行に慣れることを目指します。演習や実際のシェルスクリプトの作成を通じて、概念の実践的な理解を促進しましょう。


### 2. 変数の操作

#### 所要時間: 約 15分

このセクションでは、シェルスクリプト内での変数の操作に焦点を当てます。

1. **環境変数とユーザー定義変数**
   - 環境変数とユーザー定義変数の違いについて説明します。
   - 環境変数はシステム全体で共有される変数であり、ユーザー定義変数はシェルスクリプト内でのみ使用される変数です。

   **例:**
   ```shell
   # 環境変数の表示
   echo "ホームディレクトリ: $HOME"

   # ユーザー定義変数の宣言と使用
   my_variable="Hello, World!"
   echo $my_variable
   ```

2. **変数の代入と参照**
   - 変数に値を代入する方法と、その値を後で参照する方法を説明します。
   - 変数に文字列、数値、またはコマンドの出力を代入する方法を示します。

   **例:**
   ```shell
   my_variable="OpenAI"
   echo "変数の値: $my_variable"

   # コマンドの出力を変数に代入
   current_date=$(date)
   echo "現在の日付は: $current_date"
   ```

3. **変数のスコープ**
   - 変数のスコープについて説明し、ローカル変数とグローバル変数の違いを示します。
   - シェルスクリプト内で変数のスコープを適切に管理する方法を示します。

   **例:**
   ```shell
   # グローバル変数
   global_variable="Global Scope"

   my_function() {
       # ローカル変数
       local_variable="Local Scope"
       echo "関数内の変数: $local_variable"
   }

   my_function
   echo "関数外の変数: $local_variable"
   ```

このアウトラインを使用して、変数の操作に関するセクションの講義資料を詳細に作成できます。具体的な例と演習を追加して、学生が変数操作の理解を深めることができます。

### 3. 条件分岐

#### 所要時間: 約 20分

このセクションでは、シェルスクリプト内での条件分岐に焦点を当てます。

1. **if文を使用した条件分岐**
   - `if`文を使用して条件分岐を行う方法について説明します。
   - 条件が真の場合と偽の場合に実行すべきコマンドを指定します。

   **例:**
   ```shell
   if [ 条件 ]; then
       # 条件が真の場合に実行
   else
       # 条件が偽の場合に実行
   fi
   ```

2. **比較演算子の使用**
   - 比較演算子を使用して条件を評価する方法を示します。
   - 等号、不等号、大なり小なりなどの演算子を使用して値の比較を行います。

   **例:**
   ```shell
   if [ "$var1" -eq "$var2" ]; then
       # 条件が真の場合に実行
   fi
   ```

3. **複数の条件の組み合わせ**
   - 複数の条件を組み合わせて条件式を作成する方法を説明します。
   - `&&`（論理積）や `||`（論理和）などの演算子を使用して複雑な条件を表現します。

   **例:**
   ```shell
   if [ 条件1 ] && [ 条件2 ]; then
       # 条件1 と条件2 が両方真の場合に実行
   fi
   ```

4. **ファイルの存在をチェック**
   - ファイルの存在をチェックする方法について説明します。
   - `if`文を使用して、ファイルが存在する場合と存在しない場合の処理を行います。

   **例:**
   ```shell
   if [ -e ファイル名 ]; then
       # ファイルが存在する場合に実行
   fi
   ```

このセクションでは、条件分岐の基本的な概念を理解し、条件式の作成方法、比較演算子の使用、複数の条件の組み合わせ、ファイルの存在をチェックする方法を学びます。実際のコード例と演習を通じて、学生が条件分岐を実践的にマスターできるようサポートします。

### 4. ループ

#### 所要時間: 約 20分

このセクションでは、シェルスクリプト内でのループに焦点を当てます。

1. **forループとwhileループ**
   - `for`ループと`while`ループを使用して反復処理を行う方法について説明します。
   - 各ループの基本構文と使用ケースを紹介します。

   **例:**
   ```shell
   for item in item1 item2 item3; do
       # ループ本体
   done

   while [ 条件 ]; do
       # ループ本体
   done
   ```

2. **ループの制御構造**
   - ループ内での制御構造について説明します。
   - `break`と`continue`ステートメントを使用してループの中断とスキップを制御します。

   **例:**
   ```shell
   for item in item1 item2 item3; do
       if [ 条件 ]; then
           break  # ループの中断
       fi
       # ループ本体
   done
   ```

3. **配列の操作**
   - 配列の宣言、要素へのアクセス、およびループ内での配列の使用について説明します。
   - 配列を使用してデータを格納し、処理する方法を示します。

   **例:**
   ```shell
   # 配列の宣言
   my_array=("Item1" "Item2" "Item3")

   # 配列の要素へのアクセス
   echo "1番目の要素: ${my_array[0]}"

   for item in "${my_array[@]}"; do
       # 配列の要素を処理
   done
   ```

このセクションでは、ループの基本構文、ループの制御構造、および配列の操作に関する概念を理解し、実際のコード例と演習を通じて学生がループ処理を熟練させることを目指します。実践的なスキルを身につけるために、学生には具体的な演習を提供しましょう。

以下は、「シェルスクリプトのデバッグ」に関する講義内容の詳細なアウトラインです。


### 5. シェルスクリプトのデバッグ

#### 所要時間: 約 20分

このセクションでは、シェルスクリプトのデバッグに焦点を当てます。

1. **エラーメッセージの取得**
   - シェルスクリプト内でエラーが発生した場合、エラーメッセージの取得方法について説明します。
   - `stderr`や`$?`変数を使用してエラーメッセージを取得する方法を示します。

   **例:**
   ```shell
   command_that_might_fail
   if [ $? -ne 0 ]; then
       echo "エラーメッセージ: $?"
   fi
   ```

2. **デバッグモードの有効化**
   - シェルスクリプトをデバッグモードで実行する方法について説明します。
   - `-x`オプションを使用してスクリプトの実行中に実行されるコマンドを表示します。

   **例:**
   ```shell
   bash -x my_script.sh
   ```

3. **スクリプトのトレース**
   - スクリプト内のステップをトレースし、デバッグに役立つ方法について説明します。
   - `set -o xtrace`を使用してトレースモードを有効化し、実行されるコマンドとその出力を表示します。

   **例:**
   ```shell
   set -o xtrace
   # スクリプトのコード
   set +o xtrace  # トレースモードの無効化
   ```

このセクションでは、シェルスクリプトのデバッグ技術を学び、エラーメッセージの取得、デバッグモードの有効化、およびスクリプトのトレース方法に慣れることが目標です。学生にはデバッグスキルを向上させるための演習を提供し、シェルスクリプトのトラブルシューティング能力を向上させましょう。
